<script>
window.onload = function(){
window.focus();
}
Qualtrics.SurveyEngine.addOnload(function()
{
var pumpTimes = [document.getElementById("timeArrayDIV").innerHTML];
var perPagePT = [document.getElementById("perPagePTArrayDIV").innerHTML];
var duration;
var offTask = [document.getElementById("offTaskDIV").innerHTML];
var onTask = [document.getElementById("onTaskDIV").innerHTML];
var totalOnTaskPrev = [document.getElementById("onTaskTotalDIV").innerHTML];
var totalOffTaskPrev = [document.getElementById("offTaskTotalDIV").innerHTML];
var pageNo = parseFloat(document.getElementById("page-no-DIV").innerHTML);
		if (pageNo > 0) {
				document.getElementById("page-number").innerHTML = +pageNo + 1;
		}
			//creates a variable called timeOne containing date/time information on page load
				var timeOne = Date.now();
				window.onblur = function () {
					var window_focus = 0;
					document.getElementById("window-focus").innerHTML = window_focus;
					// creates a variable called timeTwo containing date/time information whenever Ps leave workspace div
					var timeTwo = Date.now();
					// takes the interval between timeOne and timeTwo and converts to seconds (i.e., how long Ps spend in the task window). Steps below push this value to different arrays
					var duration = (timeTwo - timeOne) / 1000;
					document.getElementById("duration-span").innerHTML = duration;
					// creates several arrays representing time spent on task and off task, time spent on and off task on that page, and just time spent on task
					timeOne = Date.now();
					pumpTimes.push(duration);
					perPagePT.push(duration);
					onTask.push(duration);
					document.getElementById("time-display2").innerHTML = pumpTimes;
						var total = 0;
						for (var i = 0; i < pumpTimes.length; i++) {
								total += pumpTimes[i] << 0;
						}
						var totalOnTask = 0;
						for (var i = 0; i < pumpTimes.length; i++) {
								totalOnTask += onTask[i] << 0;
						}
						var OnTaskSum = (+totalOnTask + +totalOnTaskPrev)
							document.getElementById("time-display").innerHTML = total;
						document.getElementById("onTaskDisplay").innerHTML = onTask;
					document.getElementById("onTaskTotalDisplay").innerHTML = OnTaskSum;
					document.getElementById("offTaskDisplay").innerHTML = offTask;
					document.getElementById("offTaskTotalDisplay").innerHTML = OffTaskSum;
			};
						window.onfocus = function() {
							var  window_focus = 1;
								document.getElementById("window-focus").innerHTML = window_focus;
					// performs equivalent series of steps, but measuring time spent off task instead
						var timeThree = Date.now();
						var duration = (0 - (timeThree - timeOne) / 1000);
						document.getElementById("duration-span").innerHTML = duration;
						pumpTimes.push(duration);
						offTask.push(duration);
						perPagePT.push(duration);
						timeOne = Date.now();
					document.getElementById("time-display2").innerHTML = pumpTimes;
						var total = 0;
						for (var i = 0; i < pumpTimes.length; i++) {
								total += pumpTimes[i] << 0;
						}

				};
		 Qualtrics.SurveyEngine.addOnPageSubmit(function() {
				 var ValidationCheck = document.getElementsByClassName('ValidationError');
				 var i;
				 for (i=0; i < ValidationCheck.length; i++) {
				 if (ValidationCheck[i].style.display == 'none') {
					 var PassValidation = 1;
				 } else {
					 PassValidation = 0;
					 break;
				 };
			 };
				 if (PassValidation == 1) {
				 var timeTwo = Date.now();
				 var duration = (timeTwo - timeOne) / 1000;
				 document.getElementById("duration-span").innerHTML = duration;
				 timeOne = Date.now();
				 pumpTimes.push(duration);
				 perPagePT.push(duration);
				 onTask.push(duration);
				 document.getElementById("time-display2").innerHTML = pumpTimes;
					 var total = 0;
					 for (var i = 0; i < pumpTimes.length; i++) {
							 total += pumpTimes[i] << 0;
					 }
					 var totalOnTask = 0;
					 for (var i = 0; i < pumpTimes.length; i++) {
							 totalOnTask += onTask[i] << 0;
					 }
					 var OnTaskSum = (+totalOnTask + +totalOnTaskPrev)
						 document.getElementById("time-display").innerHTML = total;
					 document.getElementById("onTaskDisplay").innerHTML = onTask;
				 document.getElementById("onTaskTotalDisplay").innerHTML = OnTaskSum;
				 var totalOffTask = 0;
				 for (var i = 0; i < pumpTimes.length; i++) {
				 		totalOffTask += offTask[i] << 0;
				 }
				 var OffTaskSum = (+totalOffTask + +totalOffTaskPrev)
				 document.getElementById("offTaskDisplay").innerHTML = offTask;
				 document.getElementById("offTaskTotalDisplay").innerHTML = OffTaskSum;
									pumpTimes = pumpTimes.toString();
									pumpTimes = pumpTimes.split(",@,")
									perPagePT.push(" PAGE BREAK ");
									perPagePT = perPagePT.toString();
									perPagePT = perPagePT.split(",@,")
									var total = 0;
									var total = parseFloat(document.getElementById("time-display").innerHTML);
									var totalOnTask = parseFloat(document.getElementById("onTaskTotalDisplay").innerHTML);
									var totalOffTask = parseFloat(document.getElementById("offTaskTotalDisplay").innerHTML);
									onTask = onTask.toString();
									onTask = onTask.split(",@,")
									offTask = offTask.toString();
									offTask = offTask.split(",@,")
									var pageNo = document.getElementById("page-no-DIV").innerHTML;
									pageNo++;
						Qualtrics.SurveyEngine.setEmbeddedData('worktimeArray', pumpTimes);
						Qualtrics.SurveyEngine.setEmbeddedData('perPagePT', perPagePT);
						Qualtrics.SurveyEngine.setEmbeddedData('tasktime', total);
						Qualtrics.SurveyEngine.setEmbeddedData('totalOnTask', totalOnTask);
						Qualtrics.SurveyEngine.setEmbeddedData('totalOffTask', totalOffTask);
						Qualtrics.SurveyEngine.setEmbeddedData('offTask', offTask);
						Qualtrics.SurveyEngine.setEmbeddedData('onTask', onTask);
						Qualtrics.SurveyEngine.setEmbeddedData('pageNo', pageNo);
} else {
	var pageNo = document.getElementById("page-no-DIV").innerHTML;
	pageNo --;
};
		});
			});


</script>

<div class="QuestionBody UnhiddenQuestion" data-runtime-text="runtime.WontBeDisplayedText">

		<center><br><br><span id="page-position” style=“display:none">page: <span id="page-number">1</span>
				<p></p>
				</span>
				<span>
	<div id="top-div" style="display:none">

<span><center><br><br>time: <span id="time-display"></span>
				<p></p>

				<br><br>time2: <span id="time-display2"></span></center>
				<br><br>duration: <span id="duration-span"></span>

		<br><br>offTask: <span id="offTaskDisplay"></span>

		<br><br>onTask: <span id="onTaskDisplay"></span>

		<br><br>offTaskTotal: <span id="offTaskTotalDisplay"></span>
		<br><br>Window focus: <span id="window-focus"></span>

		<br><br>onTaskTotal: <span id="onTaskTotalDisplay"></span></span>
		</span>
</div>
