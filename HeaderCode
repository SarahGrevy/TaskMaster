<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js">
</script>
<script>
Qualtrics.SurveyEngine.addOnload(function()
{  var jq = jQuery.noConflict();
    var pumpTimes = [jq('#timeArrayDIV')[0].innerHTML];
    var perPagePT = [jq('#perPagePTArrayDIV')[0].innerHTML];
    var duration = 0;
    var offTask = [jq('#offTaskDIV')[0].innerHTML];
    var onTask = [jq('#onTaskDIV')[0].innerHTML];
    var totalOnTaskPrev = [jq('#onTaskTotalDIV')[0].innerHTML];
    var totalOffTaskPrev = [jq('#offTaskTotalDIV')[0].innerHTML];
    var pageNo = parseFloat(jq('#page-no-DIV')[0].innerHTML);


    if (pageNo > 0) {

        jq('#page-number')[0].innerHTML = +pageNo + 1;

    }

      //creates a variable called timeOne containing date/time information on page load

        var timeOne = Date.now();

        jq(window).blur(function() {
          var window_focus = 0;
            jq('#window-focus')[0].innerHTML = window_focus;
          // creates a variable called timeTwo containing date/time information whenever Ps leave workspace div
          var timeTwo = Date.now();
          // takes the interval between timeOne and timeTwo and converts to seconds (i.e., how long Ps spend in the task window). Steps below push this value to different arrays
          var duration = (timeTwo - timeOne) / 1000;
          // creates several arrays representing time spent on task and off task, time spent on and off task on that page, and just time spent on task
          pumpTimes.push(duration);
          perPagePT.push(duration);
          onTask.push(duration);
          timeOne = Date.now();

           jq('#time-display2')[0].innerHTML = pumpTimes;
            var total = 0;
            for (var i = 0; i < pumpTimes.length; i++) {
                total += pumpTimes[i] << 0;
            }
            var totalOnTask = 0;
            for (var i = 0; i < pumpTimes.length; i++) {
                totalOnTask += onTask[i] << 0;

            }

            var OnTaskSum = (+totalOnTask + +totalOnTaskPrev)

            jq('#time-display')[0].innerHTML = total;
            jq('#onTaskDisplay')[0].innerHTML = onTask;
            jq('#onTaskTotalDisplay')[0].innerHTML = OnTaskSum;
    });
            jq(window).focus(function() {
              var  window_focus = 1;
                jq('#window-focus')[0].innerHTML = window_focus;

          // performs equivalent series of steps, but measuring time spent off task instead
            var timeThree = Date.now();
            var duration = (0 - (timeThree - timeOne) / 1000);
            pumpTimes.push(duration);
            offTask.push(duration);
            perPagePT.push(duration);
            timeOne = Date.now();



            jq('#time-display2')[0].innerHTML = pumpTimes;

            var total = 0;
            for (var i = 0; i < pumpTimes.length; i++) {
                total += pumpTimes[i] << 0;
            }
            var totalOffTask = 0;
            for (var i = 0; i < pumpTimes.length; i++) {    
                totalOffTask += offTask[i] << 0;

            }

            var OffTaskSum = (+totalOffTask + +totalOffTaskPrev)

            jq('#offTaskDisplay')[0].innerHTML = offTask;
            jq('#offTaskTotalDisplay')[0].innerHTML = OffTaskSum;

        });


     Qualtrics.SurveyEngine.addOnPageSubmit(function() {


         var ValidationCheck = document.getElementsByClassName('ValidationError');
         var i;
         for (i=0; i < ValidationCheck.length; i++) {
         if (ValidationCheck[i].style.display == 'none') {

           var PassValidation = 1;
         } else {
           PassValidation = 0;
           break;
         };

       };


         if (PassValidation == 1) {


                  pumpTimes = pumpTimes.toString();
                  pumpTimes = pumpTimes.split(",@,")
                  perPagePT.push(" PAGE BREAK ");
                  perPagePT = perPagePT.toString();
                  perPagePT = perPagePT.split(",@,")
                  var total = 0;
                  var total = parseFloat(jq('#time-display')[0].innerHTML);
                  var totalOnTask = parseFloat(jq('#onTaskTotalDisplay')[0].innerHTML);
                  var totalOffTask = parseFloat(jq('#offTaskTotalDisplay')[0].innerHTML);
                  onTask = onTask.toString();
                  onTask = onTask.split(",@,")
                  offTask = offTask.toString();
                  offTask = offTask.split(",@,")
                  var pageNo = jq('#page-no-DIV')[0].innerHTML;
                  pageNo++;


            Qualtrics.SurveyEngine.setEmbeddedData('worktimeArray', pumpTimes);

            Qualtrics.SurveyEngine.setEmbeddedData('perPagePT', perPagePT);


            Qualtrics.SurveyEngine.setEmbeddedData('tasktime', total);

            Qualtrics.SurveyEngine.setEmbeddedData('totalOnTask', totalOnTask);

            Qualtrics.SurveyEngine.setEmbeddedData('totalOffTask', totalOffTask);
            Qualtrics.SurveyEngine.setEmbeddedData('offTask', offTask);
            Qualtrics.SurveyEngine.setEmbeddedData('onTask', onTask);
            Qualtrics.SurveyEngine.setEmbeddedData('pageNo', pageNo);

} else {
  var pageNo = jq('#page-no-DIV')[0].innerHTML;
  pageNo --;



};




    });
      });
</script>

<div class="QuestionBody UnhiddenQuestion" data-runtime-text="runtime.WontBeDisplayedText">

    <center><br><br><span id="page-position">page: <span id="page-number">1</span>
        <p></p>
        </span>
        <span>
  <div id="top-div">

<span><center><br><br>time: <span id="time-display"></span>
        <p></p>

        <br><br>time2: <span id="time-display2"></span></center>

    <br><br>offTask: <span id="offTaskDisplay"></span>

    <br><br>onTask: <span id="onTaskDisplay"></span>

    <br><br>offTaskTotal: <span id="offTaskTotalDisplay"></span>
    <br><br>Window focus: <span id="window-focus"></span>

    <br><br>onTaskTotal: <span id="onTaskTotalDisplay"></span></span>
    </span>
</div>
